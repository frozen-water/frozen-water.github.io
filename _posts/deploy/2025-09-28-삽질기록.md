---
layout: post
title: ì‚½ì§ˆê¸°ë¡
date: 2025-09-28 18:43:14 +0900
categories: [Trouble]
tags: [ArgoCD,Kubernetes,Kafka]
---

### ğŸ› ï¸ Spring-Kafka + ArgoCD + Kafka PVC ì‚½ì§ˆ ê¸°ë¡

### 1. Spring Boot + Kafka
- **ë¬¸ì œ**: bootstrap.servers ì„¤ì • ì•ˆ ì¡í˜€ì„œ `No resolvable bootstrap urls given` ì—ëŸ¬ ë°œìƒ
- **ì›ì¸**: í™˜ê²½ë³€ìˆ˜ ì „ë‹¬ ì•ˆ ë¨
- **í•´ê²°**: values.yaml â†’ `kafka.kafka.svc.cluster.local:9092` ë¡œ ì§€ì •

---

### 2. GitHub Actions
- **ë¬¸ì œ**: manifest repo ì—…ë°ì´íŠ¸ ì‹œ push ê¶Œí•œ 403
- **ì›ì¸**: GITHUB_TOKEN ì€ ë‹¤ë¥¸ repo push ê¶Œí•œ ì—†ìŒ
- **í•´ê²°**: PAT ë§Œë“¤ì–´ `secrets.GH_PAT` ì‚¬ìš©

---

### 3. ArgoCD Application
- **ë¬¸ì œ**: `Destination server missing` ì—ëŸ¬
- **ì›ì¸**: Application CR ì˜ëª» ì‘ì„±
- **í•´ê²°**:
  ```yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: myapp
    ```

---

### 4. ArgoCD Sync ì‹¤íŒ¨
- ë¬¸ì œ: ì†ŒìŠ¤ ë³€ê²½ í›„, push í–ˆìœ¼ë‚˜ argoê°€ ê°ì§€í•˜ì§€ ëª»í•¨
- ì›ì¸: GitOpsëŠ” `values.yaml` ì•ˆì˜ tag ë¥¼ ë°”ê¿”ì•¼ ArgoCDê°€ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ ì¸ì‹

---

### **5. Kafka Helm ì°¨íŠ¸**

- **ë¬¸ì œ**: PodInitializing â†’ PVC unbound â†’ CrashLoopBackOff
- **ì›ì¸**: KRaft ëª¨ë“œì—ì„œ PVC ê¼¬ì„
- **í•´ê²°**:
```bash
$ kubectl delete pvc -n kafka -l app.kubernetes.io/name=kafka
```
- **êµí›ˆ**: Kafka Helm ì¬ì„¤ì¹˜ ì‹œ PVC ì •ë¦¬ í•„ìˆ˜

---

## **6. Spring Kafka Consumer**

- **ë¬¸ì œ**: ProducerëŠ” ë©”ì‹œì§€ ì „ì†¡ë¨, ConsumerëŠ” ë©”ì‹œì§€ ì•ˆ ì½ìŒ
- **ì›ì¸ í›„ë³´**:
  1. ê¸°ì¡´ group offset
  2. Consumer ì‹¤í–‰ ì „ì— ë©”ì‹œì§€ ë“¤ì–´ê°
  3. Kafka CrashLoopBackOff ìƒíƒœ
- **í•´ê²°**: consumer group-id ìƒˆë¡œ ì§€ì • â†’ ì •ìƒ consume
- **êµí›ˆ**: í…ŒìŠ¤íŠ¸í•  ë• group-id ìì£¼ ë°”ê¿”ë³´ê¸°
